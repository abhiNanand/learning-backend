Node.js à¤®à¥‡à¤‚ à¤œà¤¬ à¤¯à¥‚à¤œà¤¼à¤° à¤¸à¥‡ à¤ªà¤¾à¤¸à¤µà¤°à¥à¤¡ à¤†à¤¤à¤¾ à¤¹à¥ˆ, à¤¤à¥‹ à¤‰à¤¸à¥‡ direct text form à¤®à¥‡à¤‚ database à¤®à¥‡à¤‚ store à¤¨à¤¹à¥€à¤‚ à¤•à¤°à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤à¥¤
à¤¹à¤® à¤‰à¤¸à¥‡ hash à¤•à¤°à¤•à¥‡ store à¤•à¤°à¤¤à¥‡ à¤¹à¥ˆà¤‚ à¤¤à¤¾à¤•à¤¿ à¤…à¤—à¤° database leak à¤¹à¥‹ à¤œà¤¾à¤ à¤¤à¥‹ à¤­à¥€ à¤…à¤¸à¤²à¥€ password à¤•à¤¿à¤¸à¥€ à¤•à¥‹ à¤¨à¤¾ à¤®à¤¿à¤²à¥‡à¥¤

Step-by-step process
1ï¸âƒ£ bcrypt install à¤•à¤°à¥‹

npm i bcrypt 

2ï¸âƒ£ Password hash à¤•à¤°à¤¨à¤¾

const bcrypt = require("bcrypt);

const plainpassword="scret123pass";//// user se aaya password
const saltRounds=10;// // jitna jyada utna secure, lekin slow

bcrypt.hash(plainpassword,saltRounds,(err,hash)=>{
  if(err){
    console.log("Error hashing password:",err);
  }
  console.log("Hashed password",hash);
});
output will be something like this:
$2b$10$cQc07Z/e/yTuTky6412lp.ouk7zhAwAZLJNwk0AjADsZcteq8ZztC

Salt round basically ye decide karta hai ki bcrypt password ko kitni baar internally â€œprocessâ€ kare â€” jitna zyada round hoga, utna zyada secure hash milega, lekin hashing slow bhi ho jayegi.
======================================

3ï¸âƒ£ Password verify à¤•à¤°à¤¨à¤¾ (login ke time)

const enteredPassword=scret123pass; //login form se aaya hua password.

const storedHash = "$2b$10..." //database me save keya hua hash

bcrypt.compare(enteredPassword, storedHash,(err,result)=>{
  if(result){
    console.log("password matched");
  }
  else{
    console.log("Passoword incorrect");
  }
});

======================================

Hash irreversible à¤¹à¥‹à¤¤à¤¾ à¤¹à¥ˆ â€” hash à¤¸à¥‡ original password à¤¨à¤¿à¤•à¤¾à¤²à¤¨à¤¾ possible à¤¨à¤¹à¥€à¤‚ à¤¹à¥‹à¤¤à¤¾à¥¤

Salt automatically bcrypt generate à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤¤à¤¾à¤•à¤¿ à¤¹à¤° hash unique à¤¹à¥‹à¥¤

à¤•à¤­à¥€ à¤­à¥€ plain password save à¤®à¤¤ à¤•à¤°à¥‹ â€” à¤¹à¤®à¥‡à¤¶à¤¾ hash + salt à¤•à¤¾ à¤‡à¤¸à¥à¤¤à¥‡à¤®à¤¾à¤² à¤•à¤°à¥‹à¥¤

Login à¤•à¥‡ time, entered password à¤•à¥‹ hash à¤•à¤°à¤•à¥‡ compare à¤¨à¤¹à¥€à¤‚ à¤•à¤°à¤¤à¥‡,
à¤¬à¤²à¥à¤•à¤¿ bcrypt internally handle à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ compare à¤®à¥‡à¤‚à¥¤

=====================================
using Nodejs, express, mongoDb together.

const express = require("express");
const mongoose = require("mongoose");
const bcrypt = require("bcrypt");

const app = express();
app.use(express.json()); // JSON body parse

// ðŸ“Œ MongoDB connection
mongoose.connect("mongodb://127.0.0.1:27017/testdb", {
  useNewUrlParser: true,
  useUnifiedTopology: true,
})
.then(() => console.log("MongoDB connected"))
.catch(err => console.error(err));

// ðŸ“Œ User Schema
const userSchema = new mongoose.Schema({
  username: String,
  password: String // hash store à¤¹à¥‹à¤—à¤¾
});

const User = mongoose.model("User", userSchema);

// ðŸŸ¢ SIGNUP route
app.post("/signup", async (req, res) => {
  try {
    const { username, password } = req.body;

    // password hash
    const saltRounds = 10;
    const hashedPassword = await bcrypt.hash(password, saltRounds);

    // save user
    const newUser = new User({ username, password: hashedPassword });
    await newUser.save();

    res.status(201).json({ message: "User created successfully" });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

// ðŸŸ¢ LOGIN route
app.post("/login", async (req, res) => {
  try {
    const { username, password } = req.body;

    // user find
    const user = await User.findOne({ username });
    if (!user) return res.status(400).json({ message: "User not found" });

    // password verify
    const isMatch = await bcrypt.compare(password, user.password);
    if (!isMatch) return res.status(400).json({ message: "Invalid password" });

    res.json({ message: "Login successful âœ…" });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

// Start server
app.listen(3000, () => console.log("Server running on http://localhost:3000"));
===================================
with jwt. 


const express = require("express");
const mongoose = require("mongoose");
const bcrypt = require("bcrypt");
const jwt = require("jsonwebtoken");

const app = express();
app.use(express.json());

// ðŸ“Œ MongoDB connect
mongoose.connect("mongodb://127.0.0.1:27017/testdb", {
  useNewUrlParser: true,
  useUnifiedTopology: true,
})
.then(() => console.log("MongoDB connected"))
.catch(err => console.error(err));

// ðŸ“Œ User schema
const userSchema = new mongoose.Schema({
  username: String,
  password: String
});

const User = mongoose.model("User", userSchema);

// ðŸ“Œ Secret key (env à¤®à¥‡à¤‚ à¤°à¤–à¤¨à¤¾ à¤šà¤¾à¤¹à¤¿à¤)
const JWT_SECRET = "mySuperSecretKey";

// ðŸ”¹ Middleware: Token verify
function authMiddleware(req, res, next) {
  const token = req.headers["authorization"]; // "Bearer token"
  if (!token) return res.status(401).json({ message: "Token missing" });

  const actualToken = token.split(" ")[1]; // remove "Bearer "
  jwt.verify(actualToken, JWT_SECRET, (err, decoded) => {
    if (err) return res.status(403).json({ message: "Invalid token" });
    req.user = decoded; // user data store
    next();
  });
}

// ðŸŸ¢ SIGNUP
app.post("/signup", async (req, res) => {
  try {
    const { username, password } = req.body;

    // Hash password
    const hashedPassword = await bcrypt.hash(password, 10);

    const newUser = new User({ username, password: hashedPassword });
    await newUser.save();

    res.status(201).json({ message: "User created successfully" });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

// ðŸŸ¢ LOGIN
app.post("/login", async (req, res) => {
  try {
    const { username, password } = req.body;

    // Check user
    const user = await User.findOne({ username });
    if (!user) return res.status(400).json({ message: "User not found" });

    // Verify password
    const isMatch = await bcrypt.compare(password, user.password);
    if (!isMatch) return res.status(400).json({ message: "Invalid password" });

    // Generate JWT
    const token = jwt.sign({ id: user._id, username: user.username }, JWT_SECRET, {
      expiresIn: "1h" // 1 hour valid
    });

    res.json({ message: "Login successful âœ…", token });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

// ðŸŸ¢ Protected Route
app.get("/profile", authMiddleware, (req, res) => {
  res.json({ message: "This is your profile", user: req.user });
});

// Server start
app.listen(3000, () => console.log("Server running on http://localhost:3000"));



=====================================